
<script language="javascript" 
        type="text/javascript">

var current_filename = false;

function saveCurrentFile()
{
  // called from preRunTests();
  // TODO: there must always be a current file since you can't delete kata.sh
  // however, the code in _js_editor_menu.html.erb does this
  // document.observe('dom:loaded', function() 
  // {
  //    ...
  //    load('kata.sh');
  // }
  // and current_filename is set to false
  // So this will need to wait until I have stored the currently selected file
  // in the manifest.
  // params['radio_filename'] gives the name of the selected file

  if (current_filename)
  {
    fileContent(current_filename).setAttribute('value', $('editor').value);
    fileCaretPos(current_filename).setAttribute('value', getLiveCaretPos());
  }
}

function loadFile(filename)
{
  saveCurrentFile();

  var editor = $('editor');
  var pos = fileCaretPos(filename).getAttribute('value');
  editor.value = fileContent(filename).getAttribute('value');
  setLiveCaretPos(pos);

  current_filename = filename;
  //TODO: $('radio_....).checked = true;
  document.getElementById('radio_' + filename).checked = true;
}

function fileContent(filename)
{
  return $("file_content['" + filename + "']");
}

function fileCaretPos(filename)
{
  return $("file_caret_pos['" + filename + "']");
}

</script>

