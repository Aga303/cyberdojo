
<script language="JavaScript"
        type="text/javascript"><!--

function selection(name, index)
{
  $(name + '_' + index).checked = true; 
  enable_start_if_all_selected();
}

function selected(name)
{
  radio = document.getElementsByName(name); 
  for (at = 0; at != radio.length; at++)
    if (radio[at].checked)
      return true;
  return false;
}

function enable_start_if_all_selected()
{
  $('start_button').disabled = 
       !selected('avatar')
    || !selected('filesets[kata]')
    || !selected('filesets[language]');
  
  if (navigator.appName == 'Microsoft Internet Explorer')
  {
    $('start_button').disabled = false;
  }
}

document.observe('dom:loaded', function() 
{
  enable_start_if_all_selected();
});

//--></script>

<form name="avatarIndex" 
      action="/kata/view">

<noscript>
  &nbsp;
  <h2><b>You must enable JavaScript.</b></h2>
  &nbsp;
</noscript>

<input type="hidden"
       name="dojo" 
       id="dojo" 
       value="<%=h @dojo.name-%>" />

<h1><b>CyberDojo: <%= @dojo.name -%></b></h1>
<h3>
</h3>

<table>
<tr>
<td>

<table class="panel" >
  <tr><th><span class="choose_title">Avatar?</span></th></tr>
  <tr>    
    <td valign="top">
      <% chunk_size = 5 -%>
      <% chunks = chunk_array(@avatars.sort, chunk_size) -%>
      <table>
        <% chunks.each_with_index do |chunk,outer| -%>
        <tr>
        <% chunk.each_with_index do |avatar,inner| -%>
           <% index = outer*chunk_size + inner -%>
           <td onclick='selection("avatar", "<%=index-%>");'>
             <input id="avatar_<%=index-%>"
                    type="radio"
                    name="avatar"
                    value="<%=avatar.downcase-%>" />

               <img alt="<%=avatar-%>" 
                    src="/images/avatars/<%=avatar.downcase-%>.jpg"
                    title="<%=avatar.humanize-%>" />
           </td>
        <% end -%>
        </tr>
      <% end -%>
      </table>    
    </td>
  </tr>
</table>
</td>

<% @filesets.each do |name| -%>
<td valign="top">
  <div class="panel">
    <span class="choose_title"><%=name.capitalize-%>?</span>
    <% FileSet.new(name).choices.each_with_index do |choice,index| -%>
      <div onclick='selection("<%=name-%>", "<%=index-%>");'>
        <input id="<%=name-%>_<%=index-%>" 
               type="radio" 
               name="filesets[<%=name-%>]" 
               value="<%=choice-%>" />
        <%= choice -%>
      </div>    
    <% end -%>    
  </div>
</td>
<% end -%>

<td valign="top">
<input id="start_button" 
       type="submit" 
       value="Start" 
       name="start" />
</td>

</tr>
</table>

</form>

