 
<div id="traffic_lights"       
     style="width:90em;overflow:auto">
     
  <table class="panel">  

    <% all_lights = @dojo.all_increments -%>
    <% index = 0 -%>
    <% all_lights.keys.sort.each do |avatar_name| -%>
      <% lights = all_lights[avatar_name] -%>  
      <% if lights.length > 0 -%>
        <% index += 1 -%>
        <tr class="<%=parity(index)-%> traffic_light_row">
        
          <td>
            <table>
              <tr>
                <% lights.each do |light| -%>
                  <td>
                    <%  in_new_window = false -%>
                    <%= traffic_light(@dojo, avatar_name, light, in_new_window) -%>
                  </td>
                <% end -%>
              </tr>
            </table>
          </td>
            
         <%= render :partial => 'traffic_lights_summary', 
                    :locals => { :avatar_name => avatar_name, 
                                 :lights => lights,
                                 :new_window => false
                               } -%> 
        </tr>    
      <% end -%>
    <% end -%>
 
  </table>
</div>

