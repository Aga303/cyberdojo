
<script language="JavaScript"
        type="text/javascript"><!--

var dojo_name = "<%=@dojo.name-%>";
var seconds_per_column = "<%=@seconds_per_column-%>";  
var maximum_columns = "<%=@maximum_columns-%>";  

$j(document).ready(function() {
  $j('#seconds_per_column').keyup(function(event) {
    reParse(event);
  });
  $j('#maximum_columns').keyup(function(event) {
    reParse(event);
  });  
});

function reParse(event) {
  event.preventDefault();
  if (event.keyCode == 13) {
    parseSecondsPerColumn();
    parseMaximumColumns();
    rePost();
  }
}
  
function parseSecondsPerColumn() {
  var input = $j('#seconds_per_column');
  var value = input.attr('value');
  var newValue = parseInt(value);
  if (!isNaN(newValue)) {
    seconds_per_column = newValue;
  } else {
    input.attr('value', seconds_per_column);
  }
  return seconds_per_column;
}

function parseMaximumColumns() {
  var input = $j('#maximum_columns');
  var value = input.attr('value');
  var newValue = parseInt(value);
  if (!isNaN(newValue)) {
    maximum_columns = newValue;
  } else {
    input.attr('value', maximum_columns);
  }
  return maximum_columns;
}

function rePost() {
  postTo('show_inflated', {
    dojo_name: dojo_name,
    seconds_per_column: seconds_per_column,
    maximum_columns: maximum_columns
  });
}

//--></script>

<table>
  <tr>
    <td>
      <span class="small_title">
        secs/col
      </span>
      <input type="text"
             name="seconds_per_column" 
             id="seconds_per_column"
             value="<%=@seconds_per_column-%>"/>      
    </td>
  </tr>
  
  <tr>
    <td>
      &nbsp;
    </td>
  </tr>
  
  <tr>
    <td>
      <%= link_to "<span class='deflate button'>Deflate</span>", 
          { 
            :controller => :dashboard, 
            :action => :show_deflated,
            :dojo_name => @dojo.name,
            :seconds_per_column => @seconds_per_column,
            :maximum_columns => @maximum_columns
          }, 
          { :title => "Deflate time gaps" }
      -%>
    </td>
  </tr>
  
  <tr>
    <td>
      &nbsp;
    </td>
  </tr>
  
  <tr>
    <td>
      <span class="small_title">
        max cols
      </span>
      <input type="text" 
             name="maximum_columns" 
             id="maximum_columns"
             value="<%=@maximum_columns-%>"/>
    </td>
  </tr>

</table>


